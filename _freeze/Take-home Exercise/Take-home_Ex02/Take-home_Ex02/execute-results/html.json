{
  "hash": "ed58950863aa2d4714cd973acfe51ae3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-home Ex 2\"\nauthor: \"Liang Xiuhao Rydia\"\ndate: \"Oct 3, 2024\"\ndate-modified: \"last-modified\"\nexecute:\n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n---\n\n\n## Take-home Exercise 2: Discovering impacts of COVID-19 on Thailand tourism economy at the province level using spatial and spatio-temporal statistics\n\n## 1.0 Background\n\n### **1.1 Objectives**\n\nWe aim to discover:\n\n-   If the key indicators of tourism economy of Thailand are independent from space and space and time.\n\n-   If the tourism economy is indeed spatial and spatio-temporal dependent, then, you would like to detect where are the clusters and outliers, and the emerging hot spot/cold spot areas.\n\n### **1.2 The Task**\n\nThe specific tasks of this take-home exercise are as follows:\n\n-   Using appropriate function of **sf** and **tidyverse**, preparing the following geospatial data layer:\n\n    -   a study area layer in sf polygon features. It must be at [province level](https://en.wikipedia.org/wiki/Provinces_of_Thailand) (including Bangkok) of Thailand.\n\n    -   a tourism economy indicators layer within the study area in sf polygon features.\n\n    -   a derived tourism economy indicator layer in [**spacetime s3 class of sfdep**](https://sfdep.josiahparry.com/articles/spacetime-s3). Keep the time series at **month and year levels**.\n\n-   Using the extracted data, perform global spatial autocorrelation analysis by using [sfdep methods](https://is415-gaa-tskam.netlify.app/in-class_ex/in-class_ex05/in-class_ex05-glsa).\n\n-   Using the extracted data, perform local spatial autocorrelation analysis by using [sfdep methods](https://r4gdsa.netlify.app/chap10.html).\n\n-   Using the extracted data, perform emerging hotspot analysis by using [sfdep methods](https://is415-gaa-tskam.netlify.app/in-class_ex/in-class_ex05/in-class_ex05-ehsa).\n\n-   Describe the spatial patterns revealed by the analysis above.\n\n### **1.3 The Data**\n\nFor the purpose of this take-home exercise, two data sets shall be used, they are:\n\n-   [Thailand Domestic Tourism Statistics](https://www.kaggle.com/datasets/thaweewatboy/thailand-domestic-tourism-statistics) at Kaggle. We will use **version 2** of the data set.\n\n-   [Thailand - Subnational Administrative Boundaries](https://data.humdata.org/dataset/cod-ab-tha?) at HDX. We will use the province boundary data set.\n\n## 2.0 Getting Started\n\n### 2.1 Setting up the R environment\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(sfdep, tmap, \n               sf, plotly, \n               tidyverse,\n               Kendall)\n```\n:::\n\n\n### 2.2 Loading the Data\n\nLoading the tourism economy indicators data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntourism <- read_csv(\"data/rawdata/thailand_domestic_tourism_2019_2023_ver2.csv\") %>% \n  select(1,3,5:7) %>% \n  rename(province = province_eng)\n\nwrite_rds(tourism, \"data/rds/tourism.rds\")\n```\n:::\n\n\nLoading the geospatial data, extracting the study area at province level:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprovince <- st_read(\"data/rawdata\",\n                    layer = \"tha_admbnda_adm1_rtsd_20220121\" ) %>% \n  dplyr::select(3,17) %>% \n  st_transform(crs = 32647) %>% \n  rename(province = ADM1_EN ) %>% \n  mutate(province = case_when(\n    province == \"Buriram\" ~ \"Buri Ram\",\n    province == \"Chon Buri\" ~ \"Chonburi\",\n    province == \"Lop Buri\" ~ \"Lopburi\",\n    province == \"Nong Bua Lam Phu\" ~ \"Nong Bua Lamphu\",\n    province == \"Phangnga\" ~ \"Phang Nga\",\n    province == \"Prachin Buri\" ~ \"Prachinburi\",\n    province == \"Si Sa Ket\" ~ \"Sisaket\",\n    TRUE ~ province))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `tha_admbnda_adm1_rtsd_20220121' from data source \n  `C:\\rydialiang\\isss626-aug24\\Take-home Exercise\\Take-home_Ex02\\data\\rawdata' \n  using driver `ESRI Shapefile'\nSimple feature collection with 77 features and 16 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n\n```{.r .cell-code}\nwrite_rds(province, \"data/rds/province.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(province)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex02_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n### 2.3 Joining the dataset\n\nJoining the dataset using the province column.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- left_join(tourism, \n                  province) %>% \n  st_as_sf() %>% \n  st_transform(crs = 32647) %>% \n  pivot_wider(names_from = variable, values_from = value)\n  \nwrite_rds(data, \"data/rds/data.rds\")\n```\n:::\n\n\n### 2.4 Setting Seeds to Ensure Reproducibility\n\nThe set. seed() function is used to set a Random seed which Pseudo-random number generators use when generating \"random\" numbers. By using this function, we ensure that the randomly generated numbers remain the same when the code are reproduced.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(12345)\n```\n:::\n\n\n## 3.0 Exploratory Data Analysis (EDA)\n\n### 3.1 Understanding the share of Revenue across Provinces\n\nCreating revenue_all for each province.\n\n1.  Since the value of the revenue is in trillions for top provinces, we will filter out those provinces that contributes \\> \\$2 billion revenue.\n2.  This filter is just applied for the visualization so as to declutter the chart. It is for us to know which are the top provinces in terms of revenue.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- read_rds(\"data/rds/data.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nrev_all_2b <- data %>%\n  group_by(province) %>%\n  filter(revenue_all > 2000000000) %>% \n  summarise(revenue_all = sum(revenue_all, na.rm = TRUE)) %>% \n  ungroup()\n```\n:::\n\n\nTaking a look at the revenue distribution:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = rev_all_2b) +\n  geom_bar(aes(x = reorder(province, -revenue_all), \n               y = revenue_all, fill = province), \n           stat = \"identity\") +\n  labs(title = \"Total Revenue from Foreigner by Province\", x = \"Province\", y = \"Total Revenue\") +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),  \n    plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\"),\n    legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex02_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n::: callout-note\n## Revenue_all\n\n-   From this chart, we can conclude that the top 10 provinces by revenue are:\n\n    -   Bangkok\n\n    -   Phuket\n\n    -   Chonburi\n\n    -   Chang Mai\n\n    -   Krabi\n\n    -   Surat Thani\n\n    -   Prachuap Khiri Khan\n\n    -   Songkhla\n\n    -   Chiang Rai\n\n    -   Phetchaburi\n:::\n\n### 3.2 Understanding the share of Revenue from Foreigners across Provinces\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrev_for_1b <- data %>%\n  group_by(province) %>%\n  filter(revenue_foreign > 1000000000) %>% \n  summarise(revenue_foreign = sum(revenue_foreign, na.rm = TRUE)) %>% \n  ungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = rev_for_1b) +\n  geom_bar(aes(x = reorder(province, -revenue_foreign), y = revenue_foreign, fill = province), stat = \"identity\") +\n  labs(title = \"Total Revenue from Foreigner by Province\", x = \"Province\", y = \"Total Revenue\") +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),  \n    plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\"),\n    legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex02_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n### 3.3 Understanding the share of Revenue from Thai across Provinces\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrev_thai_1b <- data %>%\n  group_by(province) %>%\n  filter(revenue_thai > 2000000000) %>% \n  summarise(revenue_thai = sum(revenue_thai, na.rm = TRUE)) %>% \n  ungroup()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = rev_thai_1b) +\n  geom_bar(aes(x = reorder(province, -revenue_thai), y = revenue_thai, fill = province), stat = \"identity\") +\n  labs(title = \"Total Revenue from Thai by Province\", x = \"Province\", y = \"Total Revenue\") +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),  \n    plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\"),\n    legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex02_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n### 3.4 Comparing the Top 10\n\n| S/N | Revenue All         | Revenue Foreigner   | Revenue Thai        |\n|-----|---------------------|---------------------|---------------------|\n| 1   | Bangkok             | Bangkok             | Bangkok             |\n| 2   | Phuket              | Phuket              | Chiang Mai          |\n| 3   | Chonburi            | Chonburi            | Chonburi            |\n| 4   | Chang Mai           | Surat Thani         | Phuket              |\n| 5   | Krabi               | Krabi               | Prachuap Khiri Khan |\n| 6   | Surat Thani         | Chiang Mai          | Chiang Rai          |\n| 7   | Prachuap Khiri Khan | Phang Nga           | Phetchaburi         |\n| 8   | Songkhla            | Songkhla            | Khanchanaburi       |\n| 9   | Chiang Rai          | Prachuap Khiri Khan | Krabi               |\n| 10  | Phetchaburi         | Trat                | Rayong              |\n\n### 3.5 Understanding number of Tourist\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntourist_all <- data %>%\n  group_by(province) %>%\n  summarise(no_tourist_all = sum(no_tourist_all, na.rm = TRUE)) %>%\n  ungroup() \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = tourist_all) +\n  geom_bar(aes(x = reorder(province, -no_tourist_all), y = no_tourist_all, fill = province), stat = \"identity\") +\n  labs(title = \"Total Number of Tourist by Province\", x = \"Province\", y = \"Total Number of Tourist\") +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),  \n    plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\"),\n    legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex02_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n## 4.0 Economic Indicator Layer\n\nWe will combine all the data from 2019 to 2023 February, to take a look at how each province are different.\n\n\n::: {.cell}\n\n```{.r .cell-code}\necon <- data %>% \n  group_by(province, region_eng, geometry) %>% \n  summarise(revenue_all = sum(revenue_all, na.rm = TRUE),\n            revenue_foreign = sum(revenue_foreign, na.rm = TRUE),\n            revenue_thai = sum(revenue_thai, na.rm = TRUE),\n            no_tourist_all = sum(no_tourist_all, na.rm = TRUE))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(econ)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex02_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n## 5.0 Creating a Time Series Cube\n",
    "supporting": [
      "Take-home_Ex02_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}